<?xml version="1.0" encoding="ISO-8859-1" ?>

<!--
  $Revision: 1.10 $
  $Date: 2008/12/09 00:32:43 $
  $Author: willuhn $
 
  Copyright (c) by willuhn software & services
  All rights reserved

  This program is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

-->

<xsd:schema xml:lang="DE" elementFormDefault="qualified"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  targetNamespace="http://www.willuhn.de/schema/jameica-plugin"
  xmlns:tns="http://www.willuhn.de/schema/jameica-plugin">

  <xsd:annotation>
     <xsd:documentation>
       XML-Spezifikation des XML-Formats fuer die "plugin.xml" von Jameica-Plugins.
     </xsd:documentation>
  </xsd:annotation>

  <!-- Root-Element //-->
  <xsd:element name="plugin" type="tns:pluginType" />

  <!-- Element "plugin" //-->
  <xsd:complexType name="pluginType">
    <xsd:annotation>
      <xsd:documentation>Root-Element einer plugin.xml</xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="description" type="xsd:string" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation>Beschreibungstext für das Plugin</xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="url" type="xsd:string" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation>URL für das Online-Update des Plugins. Derzeit noch ungenutzt</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="homepage" type="xsd:string" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation>URL zur Webseite des Plugins</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="license" type="xsd:string" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation>Bezeichnung der Lizenz. Z.Bsp. GPL</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="requires"    type="tns:requiresType"    minOccurs="0" maxOccurs="1"/>
      <xsd:element name="requires"    type="tns:requiresType"    minOccurs="0" maxOccurs="1"/>
      <xsd:element name="classfinder" type="tns:classfinderType" minOccurs="0" maxOccurs="1"/>
      <xsd:element name="menu"        type="tns:menuType"        minOccurs="0" maxOccurs="1"/>
      <xsd:element name="navigation"  type="tns:navigationType"  minOccurs="0" maxOccurs="1"/>
      <xsd:element name="services"    type="tns:servicesType"    minOccurs="0" maxOccurs="1"/>
      <xsd:element name="extensions"  type="tns:extensionsType"  minOccurs="0" maxOccurs="1"/>
    </xsd:all>

    <xsd:attribute name="name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation>
          Bezeichnung des Plugins. Sollte keine Leer- oder Sonderzeichen enthalten
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="version" type="xsd:double" use="required">
      <xsd:annotation>
        <xsd:documentation>
          Versionsnummer des Plugins. Z.Bsp. 1.4
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="class" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation>
          Name der Basis-Klasse des Plugins.
          Muss von de.willuhn.jameica.plugin.AbstractPlugin abgeleitet sein.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="shared" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          Legt fest, ob das Plugin durch den globalen Classloader (shared=true)
          von Jameica geladen werden soll oder durch einen exklusiven Classloader
          (shared=false), der nur von diesem Plugin genutzt wird. Per Default
          wird der globale Classloader verwendet.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>
  
  

  <!-- Element "requires" //-->
  <xsd:complexType name="requiresType">
    <xsd:annotation>
      <xsd:documentation>Definition von Abhängigkeiten zu anderen Plugins.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:element name="import" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation>Definition einer Abhängigkeit zu einem anderen Plugin</xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:attribute name="plugin" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation>
                Name des Plugins. Das ist der Wert des Attributs name aus
                der plugin.xml des anderen Plugins.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <!-- optionale Angabe der benoetigten Versionsnummer. Moegliche Formate: "1.6-", "1.7+", "1.8" -->
          <xsd:attribute name="version" type="xsd:string" use="optional">
            <xsd:annotation>
              <xsd:documentation>
                Angabe der benötigten Versionsnummer. Z.Bsp. 1.6-, wenn das
                Plugin in einer älteren Version als 1.6 vorliegen muss; 1.7+, wenn
                es in Version 1.7 oder aktueller vorliegen muss; 1.8, wenn es
                genau in Version 1.8 vorliegen muss.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <!-- optionale Angabe, ob die Abhaengigkeit zwingend vorhanden sein muss (Default:true) -->
          <xsd:attribute name="required" type="xsd:boolean" use="optional">
            <xsd:annotation>
              <xsd:documentation>
                Abhängigkeit muss nicht zwingend erfüllt ein. Kann genutzt
                werden, wenn die Abhängigkeit nicht unbedingt vorhanden sein
                muss. Wenn das Plugin jedoch installiert ist, soll es vorher
                geladen werden. Default: true. Ohne Angabe des Attributes
                handelt es sich also um eine obligatorische Abhängigkeit.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
    <!-- optionale Angabe der benoetigten Versionsnummer. Moegliche Formate: "1.6-", "1.7+", "1.8" -->
    <xsd:attribute name="jameica" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          Optionale Angabe der benötigten Jameica-Version. Hiermit kann
          festgelegt werden, ob das Plugin eine bestimmte Jameica-Version
          voraussetzt. Mögliche Werte wie im Attribute version des Elements
          import.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <!-- Element "classfinder" //-->
  <xsd:complexType name="classfinderType">
    <xsd:annotation>
      <xsd:documentation>
        Liste von Pfadangaben (Patterns) zu Class-Dateien und Jar-Files,
        die vom Classfinder analysiert werden sollen. Alle Klassen, die
        vom Classfinder analysiert worden, können anschließend anhand der
        Interfaces gesucht werden, die sie implementieren.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="include" type="xsd:string" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation>
            Angabe einer einzelnen Pfad-Angabe. Z.Bsp.: meinplugin\.jar.
            Da es sich um einen regulären Ausdruck handelt, müssen u.a. Punkte
            mit einem Backslash escaped werden.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <!-- Element "menu" //-->
  <xsd:complexType name="menuType">
    <xsd:annotation>
      <xsd:documentation>Definition des Menu-Baumes des Plugins.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:element name="item" type="tns:menuItemType" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  
  <!-- Element "navigation" //-->
  <xsd:complexType name="navigationType">
    <xsd:annotation>
      <xsd:documentation>Definition des Navigations-Baumes des Plugins.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:element name="item" type="tns:naviItemType" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  
  <!-- Element "services" //-->
  <xsd:complexType name="servicesType">
    <xsd:annotation>
      <xsd:documentation>
        Definition der Services des Plugins. Alles Services müssen das
        Interface de.willuhn.datasource.Service implementieren.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:annotation>
        <xsd:documentation>Liste der Services.</xsd:documentation>
      </xsd:annotation>
      <xsd:element name="service" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation>Definition eines einzelnen Services</xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:attribute name="name" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation>Name des Services. Sollte keine Leerzeichen sondern höchstens Punkte enthalten</xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="class" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation>
                Name des Interfaces des Services. Wurden sowohl Interface
                als auch Implementierung vom Classfinder analysiert, findet
                Jameica automatisch die zugehörige Implementierung. Andernfalls
                muss die implementierende Klasse explizit angegeben werden.
                Die Klasse muss de.willuhn.datasource.Service implementieren.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="autostart" type="xsd:boolean" use="optional">
            <xsd:annotation>
              <xsd:documentation>
                Gibt an, ob der Service automatisch gestartet werden soll.
                Default: true.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="share" type="xsd:boolean" use="optional">
            <xsd:annotation>
              <xsd:documentation>
                Gibt an, ob der Service via RMI freigegeben werden darf.
                Default: true.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="depends" type="xsd:string" use="optional">
            <xsd:annotation>
              <xsd:documentation>
               Komma-separarierte Liste von Service-Namen innerhalb des selben
               Plugins, von denen dieser Service abhängt. Diese Services
               werden dann automatisch vorher gestartet.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <!-- Element "extensions" //-->
  <xsd:complexType name="extensionsType">
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:element name="extension" minOccurs="0" maxOccurs="unbounded">
        <xsd:complexType>
          <xsd:attribute name="class"   type="xsd:string"  use="required" />
          <xsd:attribute name="extends" type="xsd:string"  use="required" />
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>


  <!-- Element "item" in "menu"-->
  <xsd:complexType name="menuItemType">
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <!-- Rekursive Kind-Elemente -->
      <xsd:element name="item" type="tns:menuItemType" />
    </xsd:sequence>
    <xsd:attribute name="name"     type="xsd:string"  use="required" />
    <xsd:attribute name="id"       type="xsd:string"  use="optional" />
    <xsd:attribute name="action"   type="xsd:string"  use="optional" />
    <xsd:attribute name="enabled"  type="xsd:boolean" use="optional" />
    <xsd:attribute name="shortcut" type="xsd:string"  use="optional" />
  </xsd:complexType>
  
  <!-- Element "item" in "navigation"-->
  <xsd:complexType name="naviItemType">
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <!-- Rekursive Kind-Elemente -->
      <xsd:element name="item" type="tns:naviItemType" />
    </xsd:sequence>
    <xsd:attribute name="name"     type="xsd:string"  use="required" />
    <xsd:attribute name="id"       type="xsd:string"  use="optional" />
    <xsd:attribute name="action"   type="xsd:string"  use="optional" />
    <xsd:attribute name="enabled"  type="xsd:boolean" use="optional" />
    <xsd:attribute name="shortcut" type="xsd:string"  use="optional" />

    <!-- Zusaetzliche Attribute in der Navigation -->
    <xsd:attribute name="icon-open"  type="xsd:string"  use="optional" />
    <xsd:attribute name="icon-close" type="xsd:string"  use="optional" />
    <xsd:attribute name="expanded"   type="xsd:boolean" use="optional" />
  </xsd:complexType>

</xsd:schema>
